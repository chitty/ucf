	ORG	$4000
REGA	FCB	#$00
REGB	FCB	#$00
REGFL	FCB	#$00
REGX	FDB	#$0000
REGY	FDB	#$0000
REGSP	FDB	#$0000
REGPC	FDB	#$0000
TEMP	FCB	#$00
MEM1	FCB	#$F3
MEM2	FCB	#$00, #$00
MEM3	FCB	#$E4, #$5A
DELTA1	FCB	#$00
DELTA2	FCB	#$00
TEMP1	FDB	#$0000
TEMP2	FDB	#$0000
TEMP3	FDB	#$0000
TEMP4	FDB	#$0000
STRING1	FCC	'F: Fills memory with ASCII characters starting at address XXXX.'
	FCB	#$0D, #$0A
	FCC	'G: Executes code at the location XXXX.'
	FCB	#$0D, #$0A
	FCC	'R: Displays the registers.'
	FCB	#$0D, #$0A
	FCC	'A: Fills the A accumulator with XX.'
	FCB	#$0D, #$0A
	FCC	'B: Fills the B accumulator with XX.'
	FCB	#$0D, #$0A
	FCC	'L: Fills the flag register with XX.'
	FCB	#$0D, #$0A
	FCC	'X: Fills the X index register with AAAA.'
	FCB	#$0D, #$0A
	FCC	'Y: Fills the Y index register with AAAA.'
	FCB	#$0D, #$0A
	FCC	'S: Fills the stack pointer with AAAA.'
	FCB	#$0D, #$0A
	FCC	'P: Fills the program counter with AAAA.'
	FCB	#$0D, #$0A
	FCC	'M: Modifies memory at address XXXX with QQ.'
	FCB	#$0D, #$0A
	FCC	'C: Performs a logical calculator and displays the results.'
	FCB	#$0D, #$0A
	FCC	'D: Display memory as a 2 digit HEX number and an ASCII character'
	FCB	#$0D, #$0A
	FCC	'   between the values of ($21 to $7E) from addresses XXXX to YYYY.'
	FCB	#$0D, #$0A
	FCC	'Z: Sets or clears a breakpoint at address XXXX.'
	FCB	#$0D, #$0A
	FCC	'Q: Performs a branch address calculation.'
	FCB	#$0D, #$0A
	FCC	'E: Extra credit.'
	FCB	#$0D, #$0A
	FCC	'T: Terminate program.'
	FCB	#$0D, #$0A, #$04
STRING2	FCB	#$0D, #$0A
	FCC	'A: AND.'
	FCB	#$0D, #$0A
	FCC	'N: NOT.'
	FCB	#$0D, #$0A
	FCC	'O: OR.'
	FCB	#$0D, #$0A
	FCC	'E: EXOR.'
	FCB	#$0D, #$0A, #$04
STRING3	FCB	#$0D, #$0A
	FCC	'Breakpoint executed!'
	FCB	#$0D, #$0A, #$04

	ORG	$2000
	LDS	#$00FF
START	LDX	#STRING1
	JSR	OUTSTRG
	JSR	INCHAR
	JSR	OUTA
	CMPA	#'F'
	BEQ	FILL
	CMPA	#'G'
	BEQ	GO
	CMPA	#'R'
	BEQ	REG
	CMPA	#'A'
	BEQ	FILLA
	CMPA	#'B;
	BEQ	FILLB
	CMPA	#'L'
	BEQ	FILLL
	CMPA	#'X'
	BEQ	FILLX
	CMPA	#'Y'
	BEQ	FILLY
	CMPA	#'S'
	BEQ	FILLS
	CMPA	#'P'
	BEQ	FILLP
	CMPA	#'T'
	BEQ	END
	CMPA	#'M'
	BEQ	MOD1
	CMPA	#'C'
	BEQ	CALC
	CMPA	#'D'
	BEQ	DISP
	CMPA	#'Z'
	BEQ	BRK
	CMPA	#'E'
	BEQ	XTRA
	CMPA	#'Q'
	BEQ	OFSET
	JSR	CRLF
	BRA	START
FILL	JSR	FILLSUB
	JMP	START
GO	JSR	GOSUB
	JMP	START
REG	JSR	REGSUB
	JMP	START
FILLA	JSR	FASUB
	JMP	START
FILLB	JSR	FBSUB
	JMP	START
FILLL	JSR	FLSUB
	JMP	START
FILLX	JSR	FXSUB
	JMP	START
FILLY	JSR	FYSUB
	JMP	START
FILLS	JSR	FSSUB
	JMP	START
FILLP	JSR	FPSUB
	JMP	START
MOD1	JSR	MODSUB
	JMP	START
CALC	JSR	CALSUB
	JMP	START
DISP	JSR	DISPSUB
	JMP	START
BRK	JSR	BRKSUB
	JMP	START
XTRA	JSR	XTRASUB
	JMP	START
OFSET	JSR	OFSUB
	JMP	START
END	FCB	#$00
	
INCHAR  PSHB             
LOOP1 	LDAB 	$102E       
      	ANDB 	#$20
      	BEQ  	LOOP1
      	LDAA 	$102F       
      	PULB
      	RTS

OUTA  	PSHB             
LOOP2	LDAB 	$102E       
      	ANDB 	#$80
      	BEQ 	LOOP2
      	STAA 	$102F       
      	PULB
      	RTS

CRLF	PSHA
	LDAA 	#$0D
	JSR 	OUTA
	LDAA 	#$0A
	JSR 	OUTA
	PULA
	RTS

OUTSTRG	LDAA 	0,x         
	CMPA 	#$04        
	BEQ 	DONE
	JSR 	OUTA         
	INX              
	BRA 	OUTSTRG
DONE	RTS

FILLSUB	PSHX
	PSHA
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	JSR	CRLF
	LDX	MEM2
LOOP	JSR	INCHAR
	JSR	OUTA
	CMPA	#$0D
	BEQ	END1
	STAA	O,X
	INX
	BRA	LOOP
END1	JSR	CRLF
	PULA
	PULX
	RTS

PART4	PSHY
	LDY	#MEM2
	JSR	OUTPUT
	INY
	JSR	OUTPUT
	PULY
	RTS

OUTPUT	JSR	INCHAR
	CMPA	#$30
	BLO	OUTPUT
	CMPA	#$3A
	BLO	NUMBER
	CMPA	#$41
	BLO	OUTPUT
	CMPA	#$46
	BHI	OUTPUT
LETTER	JSR	OUTA
	SUBA	#$07
	SUBA	#$30
	BRA	SKIP
NUMBER	JSR	OUTA
	SUBA	#$30
SKIP	LSLA
	LSLA
	LSLA
	LSLA
	STAA	0,Y
OUTPUT2	JSR	INCHAR
	CMPA	#$30
	BLO	OUTPUT2
	CMPA	#$3A
	BLO	NUMBER1
	CMPA	#$41
	BLO	OUTPUT2
	CMPA	#$46
	BHI	OUTPUT2
	JSR	OUTA
	SUBA	#$07
	SUBA	#$30
	BRA	SKIP1
NUMBER1	JSR	OUTA
	SUBA	#$30
SKIP1	ORAA	0,Y
	STAA	0,Y
	RTS

GOSUB	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDAA	REGFL
	TAP
	LDAA	REGA
	LDAB	REGB
	LDS	REGSP
	LDX	MEM2
	PSHX
	LDX	REGX
	JSR	CRLF
	RTS

REGSUB	JSR	CRLF
	PSHX
	PSHA
	LDAA	#'A'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDAA	REGA
	STAA	MEM1
	JSR	PART1
	LDAA	#','
	JSR	OUTA
	LDAA	#'B'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDAA	REGB
	STAA	MEM1
	JSR	PART1
	LDAA	#','
	JSR	OUTA
	LDAA	#'X'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDX	REGX
	STX	MEM3
	JSR	PART3
	LDAA	#','
	JSR	OUTA
	LDAA	#'Y'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDX	REGY
	STX	MEM3
	JSR	PART3
	LDAA	#','
	JSR	OUTA
	LDAA	#'S'
	JSR	OUTA
	LDAA	#'P'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDX	REGSP
	STX	MEM3
	JSR	PART3
	LDAA	#','
	JSR	OUTA
	LDAA	#'P'
	JSR	OUTA
	LDAA	#'C'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDX	REGPC
	STX	MEM3
	JSR	PART3
	LDAA	#','
	JSR	OUTA
	LDAA	#'F'
	JSR	OUTA
	LDAA	#'L'
	JSR	OUTA
	LDAA	#'A'
	JSR	OUTA
	LDAA	#'G'
	JSR	OUTA
	LDAA	#'='
	JSR	OUTA
	LDAA	REGFL
	STAA	MEM1
	JSR	PART1
	JSR	CRLF
	PULA
	PULX
	RTS

PART3	PSHX
	LDX	#MEM3
	JSR	OUT4
	INX
	JSR	OUT4
	PULX
	RTS

PART1	PSHA
	JSR	OUT2
	PULA
	RTS
	
OUT2	PSHA
	LDAA	MEM1
	LSRA
	LSRA
	LSRA
	LSRA
	CMPA	#$0A
	BLO	NUM
	ADDA	#$07
NUM	ADDA	#$30
	JSR	OUTA
	LDAA	MEM1
	ANDA	#$0F
	CMPA	#$0A
	BLO	NUM1
	ADDA	#$07
NUM1	ADDA	#$30
	JSR	OUTA
	PULA
	RTS

OUT4	LDAA	0,X
	LSRA
	LSRA
	LSRA
	LSRA
	CMPA	#$0A
	BLO	NUM2
	ADDA	#$07
NUM2	ADDA	#$30
	JSR	OUTA
	LDAA	0,X
	ANDA	#$0F
	CMPA	#$0A
	BLO	NUM3
	ADDA	#$07
NUM3	ADDA	#$30
	JSR	OUTA
	RTS

FASUB	PSHA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	REGA
	JSR	CRLF
	PULA
	RTS

PART2	PSHY
	LDY	#MEM1
	JSR	OUTPUT
	PULY
	RTS

FBSUB	PSHA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	REGB
	JSR	CRLF
	PULA
	RTS

FLSUB	PSHA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	REGFL
	JSR	CRLF
	PULA
	RTS

FXSUB	PSHA
	PSHX
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDX	MEM2
	STX	REGX
	JSR	CRLF
	PULX
	PULA
	RTS

FYSUB	PSHA
	PSHX
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDX	MEM2
	STX	REGY
	JSR	CRLF
	PULX
	PULA
	RTS

FSSUB	PSHA
	PSHX
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDX	MEM2
	STX	REGSP
	JSR	CRLF
	PULX
	PULA
	RTS

FPSUB	PSHA
	PSHX
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDX	MEM2
	STX	REGPC
	JSR	CRLF
	PULX
	PULA
	RTS

MODSUB	PSHA
	PSHX
	PSHY
	LDAA	#$20
	JSR	OUTA
	JSR 	PART4
	LDX	MEM2
	LDAA	#$20
	JSR	OUTA
	LDAA	0,X
	STAA	MEM1
	JSR	PART1
MDLP	LDAA	#$20
	JSR	OUTA
	JSR	PART9
	LDAA	TEMP
	CMPA	#$01
	BEQ	UP9
	CMPA	#$02
	BEQ	DW9
	LDAA	MEM1
	STAA	0,X
	JSR	CRLF
	PULY
	PULX
	PULA
	RTS
UP9	LDAA	#'+'
	JSR	OUTA
	JSR	CRLF
	INX
	STX	MEM3
	JSR	PART3
	LDAA	#$20
	JSR	OUTA
	LDAA	0,X
	STAA	MEM1
	JSR	PART1
	JMP	MDLP
DW9	LDAA	#'-'
	JSR	OUTA
	JSR	CRLF
	DEX
	STX	MEM3
	JSR	PART3
	LDAA	#$20
	JSR	OUTA
	LDAA	0,X
	STAA	MEM1
	JSR	PART1
	JMP	MDLP

PART9	PSHY
	LDY	#MEM1
LP9	LDAA	#$00
	STAA	TEMP
	JSR	INCHAR
	CMPA	#'+'
	BEQ	PLUS
	CMPA	#'-'
	BEQ	MINUS
	CMPA	#$30
	BLO	LP9
	CMPA	#$3A
	BLO	LP9A
	CMPA	#$41
	BLO	LP9
	CMPA	#$46
	BHI	LP9
	JSR	OUTA
	SUBA	#$07
	SUBA	#$30
	BRA	LP9C
LP9A	JSR	OUTA
	SUBA	#$30
LP9C	LSLA
	LSLA
	LSLA
	LSLA
	STAA	0,Y
LP9D	JSR	INCHAR
	CMPA	#$30
	BLO	LP9D
	CMPA	#$3A
	BLO	LP9E
	CMPA	#$41
	BLO	LP9D
	CMPA	#$46
	BHI	LP9D
	JSR	OUTA
	SUBA	#$07
	SUBA	#$30
	BRA	LP9F
LP9E	JSR	OUTA
	SUBA	#$30
LP9F	ORAA	0,Y
	STAA	0,Y
	PULY
	RTS
PLUS	LDAA	#$01
	STAA	TEMP
	PULY
	RTS
MINUS	LDAA	#$02
	STAA	TEMP
	PULY
	RTS

CALSUB	LDX	#STRING2
	JSR	OUTSTRG
CALCLP	JSR	INCHAR
	CMPA	#'A'
	BNE	CALCN
	JSR	CALC1
	JMP	START
CALCN	CMPA	#'N'
	BNE	CALCO
	JSR	CALC2
	JMP	START
CALCO	CMPA	#'O'
	BNE	CALCE
	JSR	CALC3
	JMP	START
CALCE	CMPA	#'E'
	BNE	CALCLP
	JSR	CALC4
	JMP	START
	RTS

CALC1	LDAA	#'A'
	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	TEMP
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	ANDA	TEMP
	STAA	MEM1
	LDAA	#$20
	JSR	OUTA
	JSR	PART1
	JSR	CRLF
	RTS

CALC2	LDAA	#'N'
	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	TEMP
	COMA
	STAA	MEM1
	LDAA	#$20
	JSR	OUTA
	JSR	PART1
	JSR	CRLF
	RTS

CALC3	LDAA	#'O'
	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	TEMP
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	ORAA	TEMP
	STAA	MEM1
	LDAA	#$20
	JSR	OUTA
	JSR	PART1
	JSR	CRLF
	RTS

CALC4	LDAA	#'E'
	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	STAA	TEMP
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	EORA	TEMP
	STAA	MEM1
	LDAA	#$20
	JSR	OUTA
	JSR	PART1
	JSR	CRLF
	RTS

DISPSUB	LDAA	#$20
	JSR	OUTA
	JSR	PART5
	JSR	CRLF
	LDX	MEM2		
	LDY	MEM3		
	STY	MEM2		
DISPBEG	STX	MEM3		
	JSR	PART3
	LDAA	#$20		
	JSR	OUTA
	LDAB	#$10		
	PSHX
DISPLP	LDAA	0,X		
	STAA	MEM1
	JSR	PART1
	LDAA	#$20		
	JSR	OUTA
	CPX	MEM2		
	BEQ	DISPEND
	INX			
	DECB			
	BNE	DISPLP		
	PULX			
	LDAB	#$10		
DISP1	LDAA	0,X
	CMPA	#$21		
	BLO	DISPDOT
	CMPA	#$7E
	BHI	DISPDOT
	JSR	OUTA		
	JMP	DISP2
DISPDOT	LDAA	#'.'		
	JSR	OUTA
DISP2	LDAA	#$20		
	JSR	OUTA
	INX			
	DECB			
	BNE	DISP1
	JSR	CRLF
	JMP	DISPBEG
DISPEND	DECB			
	STAB	TEMP		
	LDAA	#$03		
	MUL
DISPF	LDAA	#$20		
	JSR	OUTA
	DECB
	BNE	DISPF
	PULX			
	LDAA	#$10
	LDAB	TEMP		
	SBA			
	TAB			
DISP4	LDAA	0,X
	CMPA	#$21		
	BLO	DPDOT
	CMPA	#$7E
	BHI	DPDOT
	JSR	OUTA		
	JMP	DISP3
DPDOT	LDAA	#'.'		
	JSR	OUTA
DISP3	LDAA	#$20		
	JSR	OUTA
	INX			
	DECB			
	BNE	DISP4
	LDAB	TEMP		
BLANK	LDAA	$20		
	JSR	OUTA
	DECB			
	BNE	BLANK
	JSR	CRLF
	RTS

PART5	PSHA
	PSHY
	LDY	#MEM2
	JSR	OUTPUT
	INY
	JSR	OUTPUT
	LDAA	#$20
	JSR	OUTA
	LDY	#MEM3
	JSR	OUTPUT
	INY
	JSR	OUTPUT
	PULY
	PULA
	RTS

BRKSUB	PSHA
	PSHB
	LDX	#SW
	STX	$FFF6
EMPEZAR	JSR	INCHAR
	CMPA	#'+'
	BEQ	MAS
	CMPA	#'-'
	BEQ	MENOS
	BRA	EMPEZAR
MAS	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	LDX	MEM2
	LDAA	TEMP
	STAA	0,X
	JSR	PART4
	LDX	MEM2
	LDAA	0,X
	STAA	TEMP
	LDAA	#$3F
	STAA	0,X
	JMP	FIN2
MENOS	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDX	MEM2
	LDAA	TEMP
	STAA	0,X
FIN2	JSR	CRLF
	PULB
	PULA
	RTS

SW	LDX	#STRING3
	JSR	OUTSTRG
	JSR	CRLF
	PULA
	STAA	REGFL
	PULB
	STAB	REGB
	PULA
	STAA	REGA
	PULX
	STX	REGX
	PULY
	STY	REGY
	PULX
	STX	REGPC
	STS	REGSP
	JSR	REGSUB
	JSR	CRLF
	RTS

XTRASUB	PSHA
	PSHX
	PSHY
	LDAA	#$20
	JSR	OUTA
	JSR	PART5
	JSR	CRLF
	LDX	MEM2
	STX	TEMP1
	LDY	MEM3
	STY	TEMP2
	LDAA	DELTA1
XLP1	CPX	TEMP2
	BEQ	XLP2
	INCA
	STAA	DELTA1
	INX
	BRA	XLP1
XLP2	LDAA	#$20
	JSR	OUTA
	LDAA	#$20
	JSR	OUTA
	JSR	PART5
	LDX	MEM2
	STX	TEMP3
	LDY	MEM3
	STY	TEMP4
	JSR	CRLF
	LDAA	DELTA2
XLP3	CPX	TEMP4
	BEQ	EXEND
	INCA
	STAA	DELTA2
	INX
	BRA	XLP3
EXEND	LDAA	DELTA1
	CMPA	DELTA2
	BLO	USED1
	BHI	USED2
	BEQ	XTRASUB
USED1	LDX	TEMP1
	LDY	TEMP2
USED2	LDX	TEMP3
	LDY	TEMP4
	PULY
	PULX
	PULA
	RTS

OFSUB	PSHA
	PSHB
	PSHX
	LDAA	#$20
	JSR	OUTA
	JSR	PART4
	LDD	MEM2
	ADDD	#$0002
	STD	MEM3
	LDAA	#$20
	JSR	OUTA
	JSR	PART2
	LDAA	MEM1
	CMPA	#$80
	BHI	TIVO
	LDAA	#$20
	JSR	OUTA
	LDX	MEM3
	LDAB	MEM1
	ABX
	STX	MEM3
	JSR	PART3
	JMP	OFEND
TIVO	LDAA	#$20
	JSR	OUTA
	LDD	MEM3
	LDAB	MEM1
	COMB
	LDAA	#$00
	COMA
	ADDD	#$0001
	ADDD	MEM3
	STD	MEM3
	JSR	PART3
OFEND	JSR	CRLF
	PULX
	PULB
	PULA
	RTS

	ORG	$5000
	LDX	REGX
	JMP	0,X
